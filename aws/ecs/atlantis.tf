module "atlantis" {
  source                        = "git::https://github.com/cloudposse/terraform-aws-ecs-atlantis.git?ref=initial_implementation"
  account_id                    = "${data.aws_caller_identity.default.account_id}"
  alb_arn_suffix                = "${module.alb.alb_arn_suffix}"
  alb_dns_name                  = "${module.alb.alb_dns_name}"
  alb_name                      = "${module.alb.alb_name}"
  alb_zone_id                   = "${module.alb.alb_zone_id}"
  atlantis_branch               = "ecs-atlantis"
  atlantis_enabled              = "true"
  atlantis_gh_team_whitelist    = "terraform:plan,engineering:*"
  atlantis_gh_user              = "cloudpossebot"
  atlantis_repo_name            = "testing.cloudposse.co"
  atlantis_repo_owner           = "cloudposse"
  atlantis_repo_whitelist       = ["github.com/cloudposse/*"]
  atlantis_wake_word            = "atlantis"
  domain_name                   = "${var.domain_name}"
  ecs_cluster_arn               = "${aws_ecs_cluster.default.arn}"
  ecs_cluster_name              = "${aws_ecs_cluster.default.name}"
  name                          = "${var.name}"
  namespace                     = "${var.namespace}"
  region                        = "${var.region}"
  stage                         = "${var.stage}"
  vpc_default_security_group_id = "${module.vpc.vpc_default_security_group_id}"
  vpc_id                        = "${module.vpc.vpc_id}"
}
