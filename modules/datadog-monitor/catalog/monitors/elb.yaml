elb-lb-httpcode-5xx-notify:
  name: "(ELB) ${tenant} ${ stage } HTTP 5XX client error detected"
  type: query alert
  query: |
    avg(last_15m):max:aws.elb.httpcode_elb_5xx{${context_dd_tags}} by {env,host,stage,tenant,environment,team} > 50
  message: |
    ({{tenant.name}}-{{environment.name}}-{{stage.name}}) lb:[ {{host}} ]
    {{#is_warning}}
    Number of HTTP 5XX client error codes generated by the load balancer > {{warn_threshold}}%
    {{/is_warning}}
    {{#is_alert}}
    Number of HTTP 5XX client error codes generated by the load balancer > {{threshold}}%
    {{/is_alert}}
    Check LB
  escalation_message: ""
  tags:
    managed-by: Terraform
  notify_no_data: false
  notify_audit: true
  require_full_window: true
  enable_logs_sample: false
  force_delete: true
  include_tags: true
  locked: false
  renotify_interval: 60
  timeout_h: 24
  evaluation_delay: 60
  new_host_delay: 300
  no_data_timeframe: 10
  threshold_windows: {}
  thresholds:
    critical: 50
    warning: 20
